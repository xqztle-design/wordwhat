<!doctype html>
<html lang="th">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
<title>Word What? ‡πÄ‡∏Å‡∏°‡∏ó‡∏≤‡∏¢‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå</title>

<link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&family=Fredoka:wght@600&display=swap" rel="stylesheet">

<style>
  :root {
    --primary: #FF9F1C;
    --primary-dark: #FFBF69;
    --text-main: #2EC4B6;
    --text-muted: #6e7c7c;
    --radius: 25px;
    --font-main: 'Kanit', sans-serif;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
  
  body {
    font-family: var(--font-main);
    height: 100vh;
    overflow: hidden; /* ‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ ‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÅ‡∏≠‡∏û */
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 16px;
    color: #2d3436;
  }

  /* =========================================
     SCENE: ‡∏â‡∏≤‡∏Å‡∏´‡∏•‡∏±‡∏á (‡∏ó‡πâ‡∏≠‡∏á‡∏ü‡πâ‡∏≤ ‡∏´‡∏ç‡πâ‡∏≤ ‡∏Å‡∏≤‡∏£‡πå‡∏ï‡∏π‡∏ô)
     ========================================= */
  .scene {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1; /* ‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏™‡∏∏‡∏î */
    background: linear-gradient(to bottom, #4facfe 0%, #00f2fe 60%, #a8e063 60%, #56ab2f 100%);
  }

  /* ‡∏Å‡πâ‡∏≠‡∏ô‡πÄ‡∏°‡∏Ü */
  .cloud {
    position: absolute;
    font-size: 5rem;
    opacity: 0.8;
    animation: floatCloud 20s linear infinite;
    top: 10%;
  }
  .c1 { left: -10%; animation-duration: 25s; }
  .c2 { top: 20%; left: -20%; animation-duration: 35s; animation-delay: 5s; font-size: 3rem; opacity: 0.6; }

  /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏ç‡πâ‡∏≤‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á */
  .grass-decor {
    position: absolute;
    bottom: 0;
    width: 100%;
    height: 40%; 
    /* ‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏ç‡πâ‡∏≤ */
    background: transparent;
  }

  /* ‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£‡πÅ‡∏•‡∏∞‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ */
  .prop {
    position: absolute;
    bottom: 38%; /* ‡∏ß‡∏≤‡∏á‡∏ö‡∏ô‡πÄ‡∏™‡πâ‡∏ô‡∏Ç‡∏≠‡∏ö‡∏´‡∏ç‡πâ‡∏≤‡∏û‡∏≠‡∏î‡∏µ (‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏° % ‡∏Ç‡∏≠‡∏á gradient body) */
    font-size: 4rem;
    filter: drop-shadow(0 5px 5px rgba(0,0,0,0.2));
  }
  
  /* ‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ */
  .tree-1 { left: -20px; font-size: 8rem; bottom: 35%; z-index: 0; }
  .tree-2 { right: -20px; font-size: 7rem; bottom: 36%; z-index: 0; }
  
  /* ‡∏™‡∏±‡∏ï‡∏ß‡πå (Animation ‡πÄ‡∏î‡πâ‡∏á‡∏î‡∏∂‡πã‡∏á) */
  .char-1 { 
    left: 15%; 
    font-size: 5rem; 
    animation: bounce 3s infinite ease-in-out;
    bottom: 37%;
  }
  .char-2 { 
    right: 15%; 
    font-size: 4.5rem; 
    animation: bounce 4s infinite ease-in-out; 
    animation-delay: 1s;
    bottom: 36%;
    transform: scaleX(-1); /* ‡∏Å‡∏•‡∏±‡∏ö‡∏î‡πâ‡∏≤‡∏ô‡πÉ‡∏´‡πâ‡∏´‡∏±‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡∏≤‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á */
  }
  .char-3 {
    left: 50%;
    margin-left: -150px; /* ‡∏Ç‡∏¢‡∏±‡∏ö‡∏´‡∏•‡∏ö‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Å‡∏•‡∏≤‡∏á */
    font-size: 3rem;
    bottom: 39%;
    animation: bounce 2s infinite;
  }

  @keyframes floatCloud { 
    0% { transform: translateX(0); } 
    100% { transform: translateX(120vw); } 
  }
  @keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
  }

  /* =========================================
     UI: ‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÄ‡∏Å‡∏°
     ========================================= */
  .container {
    width: 100%;
    max-width: 550px;
    margin: 0 auto;
    position: relative;
    z-index: 10; /* ‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡∏â‡∏≤‡∏Å‡∏´‡∏•‡∏±‡∏á */
  }

  .card {
    background: rgba(255, 255, 255, 0.95); /* ‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÅ‡∏™‡∏á‡∏ô‡∏¥‡∏î‡πÜ */
    border-radius: var(--radius);
    padding: 30px;
    box-shadow: 0 15px 30px rgba(0,0,0,0.15); 
    text-align: center;
    position: relative;
    overflow: hidden;
    border: 4px solid #fff;
    backdrop-filter: blur(5px); /* ‡πÄ‡∏ö‡∏•‡∏≠‡∏â‡∏≤‡∏Å‡∏´‡∏•‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ã‡πâ‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà */
    transition: all 0.3s ease;
  }

  .logo-area { margin-bottom: 24px; }
  h1 { 
    font-family: 'Fredoka', var(--font-main);
    font-size: 2.5rem; 
    color: #FF9F1C;
    text-shadow: 2px 2px 0px #fff, 4px 4px 0px rgba(0,0,0,0.1);
    margin-bottom: 8px;
  }
  .subtitle { color: var(--text-muted); font-size: 1rem; }

  /* Buttons */
  .btn {
    background: #FF9F1C;
    color: white;
    border: none;
    padding: 14px 28px;
    border-radius: 50px;
    font-size: 1.2rem;
    font-weight: 600;
    cursor: pointer;
    box-shadow: 0 6px 0 #e67e22;
    transition: all 0.1s;
    font-family: var(--font-main);
    display: inline-block;
    min-width: 140px;
    margin-bottom: 6px;
  }
  .btn:active { transform: translateY(6px); box-shadow: 0 0 0 #e67e22; }
  .btn.secondary {
    background: #f1f2f6;
    color: var(--text-muted);
    box-shadow: 0 6px 0 #dcdde1;
  }
  .btn.secondary:active { box-shadow: 0 0 0 #dcdde1; }
  .btn.hint {
    background: #f1c40f;
    box-shadow: 0 6px 0 #d35400;
    min-width: auto;
    padding: 10px 20px;
    font-size: 1rem;
  }
  .btn.hint:disabled {
    background: #dfe6e9;
    color: #b2bec3;
    box-shadow: none;
    cursor: not-allowed;
    transform: none;
  }

  /* Grid */
  .grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
    gap: 16px;
    margin-top: 20px;
  }
  .cat-card {
    background: #fff;
    border-radius: 20px;
    padding: 20px 10px;
    cursor: pointer;
    transition: transform 0.2s, background 0.2s;
    border: 3px solid #f1f2f6;
    box-shadow: 0 4px 10px rgba(0,0,0,0.05);
  }
  .cat-card:hover {
    background: #fff3cd;
    border-color: #FF9F1C;
    transform: translateY(-5px);
  }
  .cat-emoji { font-size: 2.5rem; display: block; margin-bottom: 8px; }
  .cat-name { font-weight: 600; color: #2d3436; font-size: 1rem; }

  /* Game Screen */
  .top-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    background: #def4fc;
    padding: 10px 20px;
    border-radius: 50px;
    border: 2px solid #bce6f7;
  }
  .score-badge { font-weight: bold; color: #0984e3; }
  .timer-badge { font-weight: bold; color: #d63031; display: flex; align-items: center; gap: 5px;}

  .word-display {
    font-size: 2.8rem;
    letter-spacing: 6px;
    font-weight: 800;
    color: #2d3436;
    margin: 30px 0;
    min-height: 60px;
    font-family: 'Fredoka', var(--font-main);
    text-transform: uppercase;
    word-break: break-word;
    line-height: 1.2;
    text-shadow: 2px 2px 0px rgba(0,0,0,0.05);
  }

  .input-area {
    display: flex;
    flex-direction: column;
    gap: 12px;
    max-width: 400px;
    margin: 0 auto;
  }
  input[type="text"] {
    width: 100%;
    padding: 16px;
    border: 3px solid #dfe6e9;
    border-radius: 20px;
    font-size: 1.4rem;
    text-align: center;
    outline: none;
    font-family: var(--font-main);
    transition: border-color 0.3s;
    background: #fdfdfd;
  }
  input[type="text"]:focus { border-color: #FF9F1C; background: #fff; }
  
  .feedback-msg {
    margin-top: 15px;
    padding: 12px;
    border-radius: 12px;
    font-weight: 600;
    display: none;
  }
  .feedback-msg.correct { background: #d4edda; color: #155724; border: 2px solid #c3e6cb; }
  .feedback-msg.wrong { background: #f8d7da; color: #721c24; border: 2px solid #f5c6cb; }

  .action-row {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-top: 15px;
  }

  /* Animations */
  @keyframes popIn { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } }
  .animate-pop { animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
  @keyframes shake { 0%{transform: translateX(0);} 25%{transform: translateX(-5px);} 75%{transform: translateX(5px);} 100%{transform: translateX(0);} }
  .shake { animation: shake 0.3s; }

  .hidden { display: none !important; }
  .w-100 { width: 100%; }

  @media (max-width: 480px) {
    .card { padding: 20px; }
    .word-display { font-size: 2rem; letter-spacing: 4px; }
    h1 { font-size: 2rem; }
    .btn { padding: 12px 20px; font-size: 1rem; }
    /* ‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÉ‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏ö‡∏±‡∏á */
    .prop { font-size: 3rem; }
    .tree-1, .tree-2 { font-size: 5rem; }
  }
</style>
</head>
<body>

<div class="scene">
  <div class="cloud c1">‚òÅÔ∏è</div>
  <div class="cloud c2">‚òÅÔ∏è</div>
  
  <div class="prop tree-1">üå≥</div>
  <div class="prop tree-2">üå≤</div>
  
  <div class="prop char-1">ü¶í</div>
  <div class="prop char-2">üêò</div>
  <div class="prop char-3">üêá</div>
</div>

<div class="container">
  
  <div id="homeScreen" class="card animate-pop">
    <div class="logo-area">
      <div style="font-size: 4rem; margin-bottom: 10px;">ü¶Åüçîüéí</div>
      <h1>Word What?</h1>
      <p class="subtitle">‡πÄ‡∏Å‡∏°‡∏ó‡∏≤‡∏¢‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©</p>
    </div>
    <button class="btn" onclick="showCategories()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°</button>
    <p style="margin-top: 20px; font-size: 0.9rem; color: #b2bec3;">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: <span id="highScore">0</span></p>
  </div>

  <div id="categoryScreen" class="card hidden animate-pop">
    <h2>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå</h2>
    <p class="subtitle">Choose a category</p>
    <div class="grid" id="categoryGrid"></div>
    <div style="margin-top: 20px;">
      <button class="btn secondary" onclick="goHome()">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
    </div>
  </div>

  <div id="gameScreen" class="card hidden">
    <div class="top-bar">
      <div class="score-badge">SCORE: <span id="currentScore">0</span></div>
      <div class="timer-badge">‚è∞ <span id="timerDisplay">60</span></div>
    </div>

    <div class="subtitle" style="margin-bottom: 5px;">‡∏´‡∏°‡∏ß‡∏î: <span id="displayCategory">...</span></div>
    
    <div id="wordBox" class="word-display">_ _ _ _ _</div>
    
    <div class="input-area">
      <input type="text" id="guessInput" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö..." autocomplete="off">
      <button class="btn w-100" id="submitBtn">‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</button>
      
      <div class="action-row">
        <button class="btn hint" id="hintBtn" onclick="useHint()">üí° ‡∏Ç‡∏≠‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ</button>
        <button class="btn secondary" onclick="endGame()">‡∏¢‡∏≠‡∏°‡πÅ‡∏û‡πâ</button>
      </div>
    </div>

    <div id="feedback" class="feedback-msg"></div>
  </div>

  <div id="resultScreen" class="card hidden animate-pop">
    <div style="font-size: 5rem; margin-bottom: 10px;" id="resultEmoji">üéâ</div>
    <h2 id="resultTitle">‡∏à‡∏ö‡πÄ‡∏Å‡∏°!</h2>
    <p class="subtitle" id="resultMsg">You did great!</p>
    
    <div style="background: #def4fc; padding: 20px; border-radius: 20px; margin: 20px 0; border: 3px solid #bce6f7;">
      <p style="font-size: 1.2rem; color: #2d3436;">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ</p>
      <h1 style="margin: 0; color: #0984e3; font-size: 3rem;" id="finalScore">0</h1>
    </div>

    <div class="action-row">
      <button class="btn secondary" onclick="goHome()">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
      <button class="btn" onclick="restartGame()">‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
    </div>
  </div>

</div>

<script>
// --- Data: Categories ---
const CATEGORIES = {
  "Animals": {
    emoji: "ü¶Å",
    words: [
      "Cow","Duck","Tiger","Fish","Bat","Cat","Dog","Chicken","Spider","Horse",
      "Buffalo","Bee","Rabbit","Pig","Sheep","Flamingo","Lion","Giraffe","Penguin","Panda",
      "Bird","Butterfly","Shark","Dolphin","Whale","Crab","Octopus","Jellyfish","Frog","Snake",
      "Mouse","Deer","Bear","Fox","Wolf","Zebra"
    ]
  },
  "Food": {
    emoji: "üçî",
    words: [
      "Hamburger","Pizza","Cheese","Bread","Bacon","Milk","Muffin","Omelette","Pancake","Toast",
      "Yogurt","Doughnut","Hot Dog","Ice Cream","Popcorn","Taco","Noodle","Milkshake","Apple Pie","Orange Juice",
      "Fried Egg","Cereal","Sandwich","Salad","Steak","Pork","Fried Rice","Curry","Cake","Sauce",
      "Soup","Meatball","Pasta"
    ]
  },
  "Fruits": {
    emoji: "üçé",
    words: [
      "Apple","Avocado","Banana","Cherry","Coconut","Orange","Durian","Grape","Guava","Jackfruit",
      "Kiwi","Lychee","Mango","Mangosteen","Melon","Papaya","Pomelo","Pear","Peach","Pineapple",
      "Strawberry","Blueberry","Watermelon","Plum","Passion Fruit","Longan"
    ]
  },
  "Vegetables": {
    emoji: "ü•¶",
    words: [
      "Corn","Bean","Bell Pepper","Mushroom","Broccoli","Carrot","Chilli","Cucumber","Celery","Garlic",
      "Ginger","Onion","Lemon","Peanut","Pepper","Potato","Pumpkin","Tomato"
    ]
  },
  "School Supplies": {
    emoji: "üéí",
    words: [
      "Eraser","Pen","Pencil","Chalk","Paper","Book","Blackboard","Ruler","Folder","Marker",
      "Ink","Cutter","Bookmark","Pencil Lead","Bin","Drawer","Printer","Notebook","Crayon","Palette",
      "White Board","Sandpaper","Stapler"
    ]
  }
};

// --- State ---
let state = {
  category: null,
  word: "",
  score: 0,
  timer: 60,
  interval: null,
  revealed: [],
  isPlaying: false
};

// --- DOM Elements ---
const screens = {
  home: document.getElementById('homeScreen'),
  cat: document.getElementById('categoryScreen'),
  game: document.getElementById('gameScreen'),
  result: document.getElementById('resultScreen')
};
const els = {
  catGrid: document.getElementById('categoryGrid'),
  wordBox: document.getElementById('wordBox'),
  input: document.getElementById('guessInput'),
  timer: document.getElementById('timerDisplay'),
  score: document.getElementById('currentScore'),
  finalScore: document.getElementById('finalScore'),
  feedback: document.getElementById('feedback'),
  displayCat: document.getElementById('displayCategory'),
  hintBtn: document.getElementById('hintBtn')
};

// --- Navigation ---
function switchScreen(name) {
  Object.values(screens).forEach(el => el.classList.add('hidden'));
  screens[name].classList.remove('hidden');
}

function goHome() {
  clearInterval(state.interval);
  document.getElementById('highScore').innerText = localStorage.getItem('ww_highscore') || 0;
  switchScreen('home');
}

function showCategories() {
  els.catGrid.innerHTML = '';
  Object.keys(CATEGORIES).forEach(key => {
    const cat = CATEGORIES[key];
    const btn = document.createElement('div');
    btn.className = 'cat-card';
    btn.innerHTML = `<span class="cat-emoji">${cat.emoji}</span><span class="cat-name">${key}</span>`;
    btn.onclick = () => startGame(key);
    els.catGrid.appendChild(btn);
  });
  switchScreen('cat');
}

// --- Game Logic ---
function startGame(categoryKey) {
  state.category = categoryKey;
  state.score = 0;
  state.timer = 60; 
  state.isPlaying = true;
  
  els.score.innerText = state.score;
  els.displayCat.innerText = categoryKey;
  
  nextWord();
  startTimer();
  switchScreen('game');
}

function nextWord() {
  const wordList = CATEGORIES[state.category].words;
  state.word = wordList[Math.floor(Math.random() * wordList.length)];
  state.revealed = new Array(state.word.length).fill(false);
  
  // Reset UI
  els.input.value = '';
  els.input.maxLength = state.word.length; // Lock input length
  els.input.focus();
  
  // Reset Hint Button
  els.hintBtn.disabled = false;
  els.hintBtn.style.opacity = 1;
  els.hintBtn.innerText = 'üí° ‡∏Ç‡∏≠‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ'; 

  hideFeedback();
  renderWord();
}

function renderWord() {
  const userGuess = els.input.value.toUpperCase();
  
  const display = state.word.split('').map((char, i) => {
    if (char === ' ') return '&nbsp;'; 

    // 1. Hint
    if (state.revealed[i]) {
        return `<span style="color:#0984e3">${char}</span>`;
    }
    
    // 2. User input
    if (userGuess[i]) {
        return userGuess[i]; 
    }

    // 3. Empty
    return '_';
  }).join(' ');

  els.wordBox.innerHTML = display;
}

function startTimer() {
  clearInterval(state.interval);
  updateTimerUI();
  state.interval = setInterval(() => {
    state.timer--;
    updateTimerUI();
    if (state.timer <= 0) {
      finishGame(false);
    }
  }, 1000);
}

function updateTimerUI() {
  els.timer.innerText = state.timer;
  if(state.timer <= 10) els.timer.style.color = 'red';
  else els.timer.style.color = '#2d3436';
}

function useHint() {
  const unrevealedIndices = state.word.split('').map((c, i) => ({c, i}))
    .filter(item => !state.revealed[item.i] && item.c !== ' ');
  
  if (unrevealedIndices.length > 0) {
    const randomItem = unrevealedIndices[Math.floor(Math.random() * unrevealedIndices.length)];
    state.revealed[randomItem.i] = true;
    
    renderWord();
    els.input.focus();

    // Disable button after 1 use
    els.hintBtn.disabled = true;
    els.hintBtn.style.opacity = 0.5;
    els.hintBtn.innerText = '‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡πâ‡∏ß';
  }
}

function checkGuess() {
  const guess = els.input.value.trim();
  if (!guess) return;

  if (guess.replace(/\s+/g,'').toLowerCase() === state.word.replace(/\s+/g,'').toLowerCase()) {
    // Correct
    state.score += 10;
    state.timer += 5; 
    els.score.innerText = state.score;
    showFeedback(true, `‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á! ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏∑‡∏≠ "${state.word}"`);
    setTimeout(() => {
      nextWord();
    }, 1500);
  } else {
    // Wrong
    els.input.classList.add('shake');
    showFeedback(false, '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏ô‡∏∞!');
    setTimeout(() => els.input.classList.remove('shake'), 400);
    els.input.focus();
  }
}

function showFeedback(isCorrect, msg) {
  els.feedback.className = `feedback-msg ${isCorrect ? 'correct' : 'wrong'}`;
  els.feedback.innerText = msg;
  els.feedback.style.display = 'block';
}

function hideFeedback() {
  els.feedback.style.display = 'none';
}

function finishGame(win) {
  clearInterval(state.interval);
  state.isPlaying = false;
  
  const oldHigh = parseInt(localStorage.getItem('ww_highscore') || '0');
  if (state.score > oldHigh) {
    localStorage.setItem('ww_highscore', state.score);
  }

  els.finalScore.innerText = state.score;
  document.getElementById('resultEmoji').innerText = state.score > 0 ? 'üèÜ' : 'üòÖ';
  document.getElementById('resultTitle').innerText = state.score > 0 ? '‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î!' : '‡πÄ‡∏ß‡∏•‡∏≤‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß';
  document.getElementById('resultMsg').innerText = `‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏Ñ‡∏∑‡∏≠ "${state.word}"`;
  
  switchScreen('result');
}

function restartGame() {
  startGame(state.category);
}

function endGame() {
  finishGame(false);
}

// --- Event Listeners ---
document.getElementById('submitBtn').addEventListener('click', checkGuess);

// Real-time update
els.input.addEventListener('input', () => {
    renderWord();
});

els.input.addEventListener('keypress', (e) => {
  if (e.key === 'Enter') checkGuess();
});

// Init
goHome();

</script>
</body>
</html>
